if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("CometHomeContactListItemsHoverCards_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"count"}],kind:"Fragment",metadata:null,name:"CometHomeContactListItemsHoverCards_viewer",selections:[{alias:null,args:[{kind:"Variable",name:"count",variableName:"count"}],concreteType:null,kind:"LinkedField",name:"chat_sidebar_contacts",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null}]}],type:"User",abstractKey:null},{args:null,kind:"FragmentSpread",name:"MWChatContact_profile"}],storageKey:null},{args:null,kind:"FragmentSpread",name:"MWChatContact_viewer"}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("MWChatContact_profile.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"MWChatContact_profile",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"DirectInboxBroadcastBucketConnection",kind:"LinkedField",name:"story_bucket",plural:!1,selections:[{alias:null,args:null,concreteType:"DirectMessageThreadBucket",kind:"LinkedField",name:"nodes",plural:!0,selections:[a,{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"first_story_to_show",plural:!1,selections:[a,{alias:null,args:null,concreteType:"StoryCardSeenState",kind:"LinkedField",name:"story_card_seen_state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_seen_by_viewer",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"story_bucket(first:1)"},{alias:null,args:[{kind:"Literal",name:"height",value:36},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:36}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_active_time",storageKey:null}]}],type:"User",abstractKey:null}],type:"Profile",abstractKey:"__isProfile"}}();e.exports=a}),null);
__d("MWChatContact_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWChatContact_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"chat_visibility",storageKey:null},{alias:null,args:null,concreteType:"PresenceViewerBasedSettings",kind:"LinkedField",name:"presence_view_side_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_active_status_viewable",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("CometHovercardGroupContainer.react",["BaseContextualLayer.react","CometPlaceholder.react","CometRelay","FocusInertRegion.react","HiddenSubtreeContextProvider.react","focusScopeQueries","react","stylex","useFadeEffect"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.contentKey,e=a.entryPointReference,f=a.isVisible,g=a.otherProps;a=babelHelpers.objectWithoutPropertiesLoose(a,["contentKey","entryPointReference","isVisible","otherProps"]);var i=c("useFadeEffect")(f),j=i[0],k=i[1];i=i[2];return!j?null:h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(c("BaseContextualLayer.react"),babelHelpers["extends"]({align:"middle"},a,{children:h.jsx(c("HiddenSubtreeContextProvider.react"),{isHidden:!f,children:h.jsx("div",{className:c("stylex").dedupe({"opacity-1":"b5wmifdl","transition-duration-1":"c5ndavph","transition-property-1":"art1omkt","transition-timing-function-1":"ot9fgl3s"},k?{"opacity-1":"pedkr2u6","transition-duration-1":"ijkhr0an","transition-timing-function-1":"s13u9afw"}:null),ref:i,children:h.jsx(c("FocusInertRegion.react"),{focusQuery:d("focusScopeQueries").tabbableScopeQuery,children:h.jsx(d("CometRelay").EntryPointContainer,{entryPointReference:e,props:g})})})})}))},b)}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometHovercardGroup.react",["CometHovercardGroupContainer.react","CometRelay","qex","react","recoverableViolation","stylex","useCometPreloader","useCometRelayEntrypointContextualEnvironmentProvider","useDelayedState","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useContext,j=e.useMemo,k=e.useRef,l=e.useState,m=250,n=50,o=h.createContext(null);function a(a){var b=a.children,d=a.preloadTrigger,e=d===void 0?"tooltip":d;d=a.xstyle;a=c("useDelayedState")(!1);var f=a[0],g=a[1];a=l(null);var i=a[0],k=a[1];a=j(function(){return{onShow:function(a){k(a),g(!0,m)},preloadTrigger:e}},[g,e]);var p=function(){g(!1,n)};return h.jsxs("div",{className:c("stylex")(d),onBlur:p,onMouseLeave:p,children:[h.jsx(o.Provider,{value:a,children:b}),i!=null&&h.jsx(c("CometHovercardGroupContainer.react"),babelHelpers["extends"]({},i,{isVisible:f}))]})}a.displayName=a.name+" [from "+f.id+"]";var p=0;function q(){return"hovercard-"+p++}function b(a){var b=a.children,e=a.entryPoint,f=a.entryPointParams,g=a.xstyle,j=babelHelpers.objectWithoutPropertiesLoose(a,["children","entryPoint","entryPointParams","xstyle"]),l=c("useCometRelayEntrypointContextualEnvironmentProvider")(),m=c("useStable")(q),n=k(null);a=i(o);var p=k(null),r=a||{},s=r.onShow;r=r.preloadTrigger;var t=function(){s!=null&&(p.current==null&&(p.current=d("CometRelay").loadEntryPoint(l,e,f)),s(babelHelpers["extends"]({},j,{contentKey:m,contextRef:n,entryPointReference:p.current})))};r=c("useCometPreloader")(r,void 0,t);var u=r[0],v=r[1];r=r[2];a==null&&c("recoverableViolation")("CometHovercardGroup: Cannot render a CometHovercardGroup.Child outside of a CometHovercardGroup.Group. ","comet_ui");a={onBlur:v,onFocus:u,onMouseDown:r,onMouseEnter:u,onMouseLeave:v,onTouchCancel:v,onTouchEnd:v,onTouchStart:u};r={onFocus:t,onMouseEnter:t};v=r;u=c("qex")._("458");u==="button_aggressive"&&(v=a);return h.jsx("div",babelHelpers["extends"]({className:c("stylex")(g)},v,{children:b(n)}))}b.displayName=b.name+" [from "+f.id+"]";g.Group=a;g.Child=b}),98);
__d("LSThreadAttributionStore.re",["LSThreadAttributionStore.bs","bs_curry"],(function(a,b,c,d,e,f){a=function(a,c){a=b("bs_curry")._2(b("LSThreadAttributionStore.bs").setSource,a,c);return a};f.setSource=a;c=function(a,c){a=b("bs_curry")._2(b("LSThreadAttributionStore.bs").setLSMessagingThreadAttribution,a,c);return a};f.setLSMessagingThreadAttribution=c}),null);
__d("MWLSPreloadThreadForContact.re",["MWLSPreloadThreadForContact.bs"],(function(a,b,c,d,e,f){a=b("MWLSPreloadThreadForContact.bs").usePreloaderForUser;f.usePreloaderForUser=a}),null);
__d("XCometActiveContactsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/active/t/{thread_key}/",Object.freeze({}),["/messages/active/"],void 0);b=a;g["default"]=b}),98);
__d("MWChatContact.react",["CometGlobalPanelGating","CometRelay","CurrentEnvironment","JSResourceForInteraction","JSScheduler","LSThreadAttributionStore.re","MWChatContact_profile.graphql","MWChatContact_viewer.graphql","MWLSPreloadThreadForContact.re","TetraListCell.react","XCometActiveContactsControllerRouteBuilder","XCometMessengerControllerRouteBuilder","XCometStoriesControllerRouteBuilder","gkx","qex","react","recoverableViolation","useCometPreloader"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("react"),k=d("react").useCallback,l=c("JSResourceForInteraction")("MWV2ChatTab.bs").__setRef("MWChatContact.react");function a(a){var e=a.entryPoint,f=a.openTabForUser,g=a.preventLocalNavigation;g=g===void 0?!0:g;var m=a.profile,n=a.selected;n=n===void 0?!1:n;a=a.viewer;a=d("CometRelay").useFragment(h!==void 0?h:h=b("MWChatContact_viewer.graphql"),a);var o=c("qex")._("1285");o=o===!0?(a==null?void 0:(o=a.presence_view_side_settings)==null?void 0:o.is_active_status_viewable)===!0:(a==null?void 0:a.chat_visibility)===!0;a=d("CometRelay").useFragment(i!==void 0?i:i=b("MWChatContact_profile.graphql"),m);m=a.availability;var p=a.id,q=a.last_active_time,r=a.name,s=a.profile_picture,t,u="none";a=(a=a.story_bucket)==null?void 0:a.nodes;a=a?a[0]:null;if(a!=null){var v,w=a.id;v=(v=a.first_story_to_show)==null?void 0:v.id;a=a==null?void 0:(a=a.first_story_to_show)==null?void 0:(a=a.story_card_seen_state)==null?void 0:a.is_seen_by_viewer;a!=null&&(u=a?"seen":"unseen");if(u!=="none"&&w!=null&&v!=null){a=c("XCometStoriesControllerRouteBuilder").buildURL({bucket_id:w,card_id:v,view_single:!0});t={prefetchQueriesOnHover:!0,url:a}}}w=k(function(){c("gkx")("1512630")&&d("JSScheduler").scheduleSpeculativeCallback(function(){l.preload()})},[]);var x=c("MWLSPreloadThreadForContact.re").usePreloaderForUser();v=k(function(){p!=null&&x(p)},[p,x]);a=c("useCometPreloader")("button",w,v);var y=a[0];w=a[1];var z=a[2],A=a[3];v=k(function(a){z!=null&&z(a),p!=null&&f(p,!1)},[z,p,f]);a=k(function(a){z!=null&&z(a),p!=null&&c("LSThreadAttributionStore.re").setSource(p,e)},[z,p,e]);var B=k(function(a){y(a),A(!0)},[y,A]);s=s==null?void 0:s.uri;if(p==null)return c("recoverableViolation")("Chat contact list cell is missing id","comet_ui");if(r==null)return c("recoverableViolation")("Chat contact list cell is missing name","comet_ui");if(s==null)return c("recoverableViolation")("Chat contact list cell is missing profileUri","comet_ui");m=m==="ACTIVE";o=o?q:void 0;q={addOn:m?{type:"availabilityBadge"}:o!=null?{border:"web-wash",time:o,type:"lastActiveTimeBadge"}:void 0,linkProps:t!=null?t:void 0,shape:"circle",size:d("CometGlobalPanelGating").isGlobalPanelM3Enabled()?24:36,source:{uri:s},storyStatus:u,type:"profile-photo"};m=c("gkx")("1950");o=m?c("XCometActiveContactsControllerRouteBuilder"):c("XCometMessengerControllerRouteBuilder");s=c("CurrentEnvironment").facebookdotcom?o.buildURL({thread_key:p}):(m?"/active":"")+"/t/"+p+"/";return j.jsx(c("TetraListCell.react"),{addOnPrimary:q,disabled:!1,headline:r,level:4,linkProps:{preventLocalNavigation:g,url:s},onHoverIn:B,onHoverOut:w,onPress:g?v:a,selected:n,testid:void 0})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometHomeContactListItemsHoverCards.react",["CometHomeContactListItemsHoverCards_viewer.graphql","CometHovercardGroup.react","CometHovercardQueryRenderer.entrypoint","CometRelay","MWChatContact.react","MWChatFilterContacts","emptyFunction","qex","react","useActorHovercardContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");function a(a){var e=a.openTabForUser;a=a.viewer$key;var f=c("useActorHovercardContext")(),g=d("CometRelay").useFragment(h!==void 0?h:h=b("CometHomeContactListItemsHoverCards_viewer.graphql"),a);a=(a=g==null?void 0:g.chat_sidebar_contacts)!=null?a:[];a=d("MWChatFilterContacts").filter(a);a=a.filteredContacts;var j=c("qex")._("458"),k="tooltip";j==="button_aggressive"&&(k=j);return i.jsx(d("CometHovercardGroup.react").Group,{preloadTrigger:k,children:a.map(function(a){var b;return i.jsx("li",{children:i.jsx(d("CometHovercardGroup.react").Child,{entryPoint:c("CometHovercardQueryRenderer.entrypoint"),entryPointParams:{context:f,entityID:(b=a.id)!=null?b:""},otherProps:{onClose:c("emptyFunction"),visualStyle:"without_action_bar"},position:"start",children:function(b){return i.jsx("div",{ref:b,children:i.jsx(c("MWChatContact.react"),{entryPoint:"sidebarContactsList",openTabForUser:e,profile:a,viewer:g})})}})},a.id)})})}a.displayName=a.name+" [from "+f.id+"]";e=i.memo(a,function(a,b){return b.preventReordering});g["default"]=e}),98);/*FB_PKG_DELIM*/
__d("LSFetchAggregatedUserPresenceCountsForCommunities",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("folder_ids",a[0]),d[0].set("use_case",[0,1]),d[1]=d[0].get("use_case"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),["fetch_community_messaging_presence","_",c.i64.to_string(d[1])].join(""),[0,502],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("MWInboxPersistedUIState.bs",["WebStorage","WebStorage.bs","bs_belt_Option","bs_caml_option","react","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j=b("WebStorage.bs").getLocalStorage(void 0);function a(a,c){var d=i.useState(function(){var d=b("bs_belt_Option").flatMap(j,function(a){return b("bs_caml_option").nullable_to_opt(a.getItem(c))});if(d===void 0)return a;try{d=b("bs_caml_option").some(JSON.parse(d))}catch(a){b("recoverableViolation")("Unable to parse value at "+c,"messenger_web_product"),d=void 0}if(d!==void 0)return b("bs_caml_option").valFromOption(d);else return a}),e=d[0];i.useEffect(function(){var d=JSON.stringify(e);if(d!==void 0){var a=b("bs_belt_Option").flatMap(j,function(a){return b("bs_caml_option").nullable_to_opt((h||(h=b("WebStorage"))).setItemGuarded(a,c,d))});a!==void 0&&b("recoverableViolation")("Unable to set item at path "+c,"messenger_web_product")}},[e,c]);return[e,d[1]]}f.localStorage=j;f.useHook=a}),null);
__d("MWPThreadPreview.bs",["LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSDatabaseType.bs","LSLocalCreateOptimisticGroupThread","LSMessagingThreadTypeUtil.bs","LSTransaction.bs","LSVec.bs","LSVerifyContactRowExists","LSVerifyThreadRowExists","MWPActor.bs","MWPThreadTheme.bs","MWThreadKey.bs","MessagingThreadType.bs","Promise","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_belt_Option","bs_caml","bs_caml_array","bs_caml_option","bs_curry","bs_int64","cr:2891","promiseDone","react","recoverableViolation","stylex","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react"),j={container:{display:"j83agx80",flexDirection:"cbu4d94t",flexGrow:"buofh1pr",minHeight:"tgvbjcpo",fontSize:"jq4qci2q"},preview:{flexGrow:"buofh1pr",minHeight:"tgvbjcpo",display:"j83agx80",flexDirection:"cbu4d94t"},composer:{minHeight:"pxsmfnpt",flexShrink:"pfnyh3mw"}};function k(a){var c=b("useReStore")();i.useEffect(function(){b("LSTransaction.bs").run(c,function(c){return b("Promise").all(a.map(function(a){return b("LSVerifyContactRowExists")(a.id,b("LSContactIdType.bs").fbid,void 0,void 0,b("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,b("LSContactBlockedByViewerStatus.bs").unblocked,void 0,!1,b("LSAuthorityLevel.bs").clientPartial,void 0,void 0,b("LSContactWorkForeignEntityType.bs").unknown,b("LSContactGender.bs").unknown,b("LSContactViewerRelationship.bs").unknown,void 0,b("LS.bs").make(c))}))},"readWrite")},[c,JSON.stringify(a.map(function(a){return b("bs_int64").to_string(a.id)}))])}function l(a){var c=a.thread,d=a.renderThreadView,e=a.renderThreadPreview;a=a.children;if(e!==void 0)return b("bs_curry")._2(e,c,a);else return i.jsx(b("MWThreadKey.bs").make,{id:c.threadKey,children:i.jsxs("div",{className:(h||(h=b("stylex")))(j.container),children:[i.jsx("div",{className:h(j.preview),children:i.jsx(b("MWPThreadTheme.bs").make,{themeFbid:c.themeFbid,children:b("bs_curry")._1(d,c)})}),i.jsx("div",{className:h(j.composer),children:a})]})})}c={make:l};function m(a){var c=a.recipientToken,d=a.setPreviewThread,e=a.renderThreadView,f=a.renderThreadPreview;a=a.children;var g=b("useReStore")(),h=c.threadType,j=c.id;k([c]);i.useEffect(function(){b("promiseDone")(b("LSTransaction.bs").run(g,function(a){return b("LSVerifyThreadRowExists")(j,h,b("LSDatabaseType.bs").mailbox,b("LS.bs").make(a))},"readWrite"),void 0,void 0)},[g,b("bs_int64").to_string(j),JSON.stringify(h)]);var m=b("ReQLSubscription.bs").useFirst(i.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(g.table("threads")),{hd:j,tl:0})},[g,j]));i.useEffect(function(){b("bs_curry")._1(d,function(a){return m})},[m]);if(m!==void 0)return i.jsx(l,{thread:m,renderThreadView:e,renderThreadPreview:f,children:a});else return null}d={make:m};function n(a,c,d,e){var f=b("useReStore")(),g=b("bs_int64").to_string(b("MWPActor.bs").useActor(void 0)),h=b("ReQLSubscription.bs").useArray(i.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(f.table("participants")),function(a){return c.has(b("bs_int64").to_string(a.contactId))}),function(a){return b("bs_int64").to_string(a.threadKey)})},[f,c]));return b("ReQLSubscription.bs").useFirst(i.useMemo(function(){var a,d=new Set(h);return(a=b("ReQL.bs")).filter(a.filter(a.filter(a.filter(a.fromTableAscending(f.table("threads")),function(a){return b("bs_caml").i64_eq(a.threadType,e)}),function(a){return a.threadName===void 0}),function(a){a=a.clientThreadKey;if(a!==void 0)return d.has(b("bs_int64").to_string(a));else return!1}),function(a){a=a.clientThreadKey;if(a===void 0)return!1;a=b("ReQLSuspense").toArray(b("ReQL.bs").filter(b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexDescending(f.table("participants").index("threadKeyReadWatermarkTimestampMs")),{hd:a,tl:0}),function(a){return b("bs_int64").to_string(a.contactId)}),function(a){return a!==g}));if(a.every(function(a){return c.has(a)}))return a.length===c.size;else return!1})},[f,h,c,g,JSON.stringify(e)]))}function o(a,c,d,e){var f=b("useReStore")();i.useEffect(function(){a===void 0&&b("promiseDone")(b("LSTransaction.bs").run(f,function(a){if(b("bs_caml").i64_eq(c,b("MessagingThreadType.bs").group))return b("LSLocalCreateOptimisticGroupThread")(b("LSVec.bs").make(d.map(function(a){return a.id})),void 0,e,b("LS.bs").make(a)).then(function(a){});else if(b("LSMessagingThreadTypeUtil.bs").isSecure(c))if(b("cr:2891")==null)return b("Promise").resolve(void 0);else return b("bs_curry")._3(b("cr:2891").call,a,d,c).then(function(a){});else{b("recoverableViolation")("Don't know how to create optimistic thread for thread of thread type"+b("bs_belt_Option").getWithDefault(JSON.stringify(c),""),"messenger_web_product");return b("Promise").resolve(void 0)}},"readWrite"),void 0,void 0)},[f,d,JSON.stringify(a),JSON.stringify(c)])}function p(a){var c=a.tokens,d=a.tokensExcludingActor,e=a.tokenContactIdsExcludingActor,f=a.setPreviewThread,g=a.threadType,h=a.renderThreadView,j=a.renderThreadPreview,m=a.checkExistingThreads;a=a.children;var p=n(d,e,f,g);k(d);o(p,g,c,m);i.useEffect(function(){b("bs_curry")._1(f,function(a){return p})});if(p!==void 0)return i.jsx(l,{thread:p,renderThreadView:h,renderThreadPreview:j,children:a});else return null}e={useFindMatchingOptimisticThreadWithParticipants:n,useCreateOptimisticThreadForTokens:o,make:p};function q(a,c,d,e,f){var g=b("useReStore")(),h=b("bs_int64").to_string(b("MWPActor.bs").useActor(void 0)),j=b("ReQLSubscription.bs").useArray(i.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(g.table("participants")),function(a){return c.has(b("bs_int64").to_string(a.contactId))}),function(a){return b("bs_int64").to_string(a.threadKey)})},[g,c]));return b("ReQLSubscription.bs").useFirst(i.useMemo(function(){var a,d=new Set(j);return(a=b("ReQL.bs")).filter(a.filter(a.filter(a.filter(a.filter(a.fromTableAscending(g.table("threads")),function(a){return b("bs_caml").i64_eq(a.threadType,e)}),function(a){return a.threadName===void 0}),function(a){if(f)return!0;else return b("bs_caml").i64_eq(a.authorityLevel,b("LSAuthorityLevel.bs").optimistic)}),function(a){return d.has(b("bs_int64").to_string(a.threadKey))}),function(a){a=b("ReQLSuspense").toArray(b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexDescending(g.table("participants").index("threadKeyReadWatermarkTimestampMs")),{hd:a.threadKey,tl:0}),function(a){return b("bs_int64").to_string(a.contactId)}));var d=a.filter(function(a){return a!==h});if(a.length===d.length||d.length!==c.size)return!1;else return d.every(function(a){return c.has(a)})})},[g,j,c,h,JSON.stringify(e)]))}function r(a){var c=a.tokensExcludingActor,d=a.tokens,e=a.threadType,f=a.setPreviewThread,g=a.renderThreadView,h=a.renderThreadPreview,j=a.checkExistingThreads;a=a.children;var k=i.useMemo(function(){return new Set(c.map(function(a){return b("bs_int64").to_string(a.id)}))},[c]),m=q(c,k,f,e,j);i.useEffect(function(){m!==void 0&&b("bs_curry")._1(f,function(a){return m})},[m]);if(m!==void 0)return i.jsx(l,{thread:m,renderThreadView:g,renderThreadPreview:h,children:a});else return i.jsx(p,{tokens:d,tokensExcludingActor:c,tokenContactIdsExcludingActor:k,setPreviewThread:f,threadType:e,renderThreadView:g,renderThreadPreview:h,checkExistingThreads:j,children:a})}var s={useFindExistingThreadWithTokens:q,make:r};function a(a){var c=a.tokens,d=a.areWeCreatingASecureThread,e=a.setPreviewThread,f=a.nullstate,g=a.renderThreadView,h=a.renderThreadPreview,j=a.checkExistingThreads;a=a.children;f=f!==void 0?b("bs_caml_option").valFromOption(f):null;j=j!==void 0?j:!0;var k=b("MWPActor.bs").useActor(void 0),l=i.useMemo(function(){return c.filter(function(a){return b("bs_caml").i64_neq(a.id,k)})},[c,k]);i.useEffect(function(){c.length===0&&b("bs_curry")._1(e,function(a){})},[c]);if(c.length===0)return f;var n=l.length;if(n!==1){if(n===0)if(d)return f;else return i.jsx(m,{recipientToken:b("bs_caml_array").get(c,0),setPreviewThread:e,renderThreadView:g,renderThreadPreview:h,children:a})}else{n=l[0];if(j)if(d)return i.jsx(r,{tokensExcludingActor:l,tokens:c,threadType:b("MessagingThreadType.bs").secureMessageOverWaOneToOne,setPreviewThread:e,renderThreadView:g,renderThreadPreview:h,checkExistingThreads:j,children:a});else return i.jsx(m,{recipientToken:n,setPreviewThread:e,renderThreadView:g,renderThreadPreview:h,children:a})}return i.jsx(r,{tokensExcludingActor:l,tokens:c,threadType:d?b("MessagingThreadType.bs").secureMessageOverWaGroup:b("MessagingThreadType.bs").group,setPreviewThread:e,renderThreadView:g,renderThreadPreview:h,checkExistingThreads:j,children:a})}var t=b("cr:2891");a=a;f.$MAWCreateOptimisticSecureThread$requireCondXplat=b("cr:2891");f.mawCreateOptimisticSecureThread=t;f.styles=j;f.ExistingThreadPreview=c;f.CanonicalThreadPreview=d;f.OptimisticThread=e;f.PossiblyOptimisticThread=s;f.make=a}),null);